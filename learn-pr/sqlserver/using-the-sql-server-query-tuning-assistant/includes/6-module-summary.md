In this module you learned about the Query Store feature, introduced in SQL Server 2016, and how it offers flight data recorder style data collection that enables you to continually monitor query performance. The Query Store can be enabled on any database on an instance of SQL Server 2016 or higher, regardless of the database compatibility level. Furthermore, it is ideal for A/B testing where you monitor the effect of making one change, such as adding or altering an index, or upgrading a database.

You also learned about the cardinality estimator algorithm, and how this was re-written in SQL Server 2014. As a result, when the compatibility level of a migrated database is moved, the new cardinality estimator is then used. This can cause performance issues, which the Query Store, along with the Query Tuning Assistant (QTA), can help you resolve. You learned that the QTA finds regressing queries and experiments to find the best performance fix. You can then use these to create plan guides.

The combination of the Query Store and QTA is ideal for monitoring database performance after an upgrade. You learned that you should migrate a database to SQL Server 2017 and leave the compatibility level in place. Then you enable the Query Store to collect baseline data. When enough statistics have been gathered, the database compatibility can be changed. The Query Store then continues to gather data on the upgraded database, and the QTA compares the before and after to find and fix regressing queries.