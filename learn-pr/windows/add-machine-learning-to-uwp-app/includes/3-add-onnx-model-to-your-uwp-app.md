
> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE2Mcxn]

Let's take the next step to incorporate machine learning into your UWP app. We add the Windows ML API to our UWP app resources in the `MainPage.xaml.cs` file. Add the API with the `using` directive:

```
using Windows.AI.MachineLearning;
```

By using this Windows ML API, apps can load machine learning models, bind features, and then evaluate the results. See the Windows ML API reference page that's linked at the end of this course.

## Download a pretrained model

Now we can load a pretrained machine learning model into our app. Windows ML evaluates models by using the Open Neural Network Exchange (ONNX) format. ONNX is an open format for ML models. With ONNX, you can interchange models between various frameworks and tools. 

There are several ways to get an ONNX model to use with Windows ML on a Windows 10 device:

- Download a pretrained ONNX model from the **ONNX Model Zoo**.
- Train your own model with a service:
    - **Azure Cognitive Services** for prebuilt models that you can train with the Vision, Speech, Knowledge, Search, or Language AI.
    - **Azure Machine Learning** to train, deploy, and manage your own models.
    - **Visual Studio Tools for AI**, an extension that supports deep learning frameworks. These frameworks include Microsoft Cognitive Toolkit (previously CNTK), Google TensorFlow, Theano, Keras, Caffe2, and more. 
- Convert models trained in other ML frameworks into ONNX format with **WinMLTools** or by using the **ONNX model format tutorials**.

For the purposes of this course, we downloaded the MNIST - Handwritten Digit Recognition model from the ONNX Model Zoo to use with our app. This model predicts handwritten digits by using a convolutional neural network. We applied only a relatively simple level of training to the model. So it can identify handwritten numbers 1 to 9 with a reasonable level of confidence and accuracy. 

## Add the ONNX model to your UWP project

The `mnist.onnx` model file is in the **Assets** folder of your project. To add it to your UWP project in Visual Studio, take the following steps:

:::row:::
    :::column:::
Right-click on the **MNIST_Demo (Universal Windows)** folder in the Solution Explorer. Select **Add** > **Existing Item**. â€‹
        
Point the file picker to the location of the `mnist.onnx` model. Select **Add**.
        
Visual Studio adds the ONNX model and autogenerates a CS file:
- `mnist.onnx`. Your pretrained model.
- `mnist.cs`. The Windows ML autogenerated code.

The autogenerated `mnist.cs` file contains three classes:
- **mnistModel** creates the machine learning model representation. It establishes a session on the system default device. It also binds the specific inputs and outputs to the model.
- Evaluates the model asynchronously. 
- **mnistInput** initializes the input types that the model expects. In this case, the input expects an [ImageFeatureValue](https://docs.microsoft.com/uwp/api/windows.ai.machinelearning.imagefeaturevalue).
- **mnistOutput** initializes the types that the model will output. In this case, the output is a list called `Plus214_Output_0` of type [TensorFloat](https://docs.microsoft.com/uwp/api/windows.ai.machinelearning.tensorfloat).

Right-click on the `mnist.onnx` model in the **Assets** folder and select **Properties**. In the **Properties** window, check to make sure the **Build Action** is set to **Content**. By using this setting, you can retrieve a file as a stream via `Application.GetContentStream(URI)`. For this method to work, it needs an `AssemblyAssociatedContentFile` custom attribute. Visual Studio adds the attribute when you mark the file as **Content**.
    :::column-end:::
    :::column:::
        ![Solution Explorer with new ONNX model files](../media/MNIST_onnx_model_files.png)
    :::column-end:::
:::row-end:::

Now we can use the autogenerated classes in the `mnist.cs` file to load, bind, and evaluate the model in our project.
