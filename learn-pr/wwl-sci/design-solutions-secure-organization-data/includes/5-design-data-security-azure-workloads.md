Microsoft Defender offers workload protections for multiple Azure workloads, such as:

- Azure SQL
- Azure Synapse Analytics
- Azure Cosmos DB

## Defender for Azure SQL

> [!NOTE]
> Defender for Azure SQL protects read-write replicas of:
> - Azure SQL single databases and elastic pools
> - Azure SQL Managed Instance
> - Azure Synapse Analytics (formerly SQL DW) dedicated SQL pool

Microsoft Defender for Azure SQL helps you discover and mitigate potential [database vulnerabilities](https://learn.microsoft.com/azure/defender-for-cloud/sql-azure-vulnerability-assessment-overview) and alerts you to [anomalous activities](https://learn.microsoft.com/azure/defender-for-cloud/defender-for-sql-introduction#advanced-threat-protection) that may be an indication of a threat to your databases.

-   [Vulnerability assessment](https://learn.microsoft.com/azure/defender-for-cloud/defender-for-sql-introduction#discover-and-mitigate-vulnerabilities): Scan databases to discover, track, and remediate vulnerabilities. Learn more about [vulnerability assessment](https://learn.microsoft.com/azure/defender-for-cloud/sql-azure-vulnerability-assessment-overview).
-   [Threat protection](https://learn.microsoft.com/azure/defender-for-cloud/defender-for-sql-introduction#advanced-threat-protection): Receive detailed security alerts and recommended actions based on SQL Advanced Threat Protection to provide to mitigate threats. Learn more about [SQL Advanced Threat Protection](https://learn.microsoft.com/azure/azure-sql/database/threat-detection-overview).

When you enable **Microsoft Defender for Azure SQL**, all supported resources that exist within the subscription are protected. Future resources created on the same subscription will also be protected.

### What are the benefits of Microsoft Defender for Azure SQL?

#### Discover and mitigate vulnerabilities

A vulnerability assessment service discovers, tracks, and helps you remediate potential database vulnerabilities. Assessment scans provide an overview of your SQL machines' security state, and details of any security findings. Defender for Azure SQL helps you identify and mitigate potential database vulnerabilities and detecting anomalous activities that could indicate threats to your databases.

#### Advanced threat protection

An advanced threat protection service continuously monitors your SQL servers for threats such as SQL injection, brute-force attacks, and privilege abuse. This service provides action-oriented security alerts in Microsoft Defender for Cloud with details of the suspicious activity, guidance on how to mitigate to the threats, and options for continuing your investigations with Microsoft Sentinel. Learn more about [advanced threat protection](https://learn.microsoft.com/azure/azure-sql/database/threat-detection-overview).

Threat intelligence enriched security alerts are triggered when there's:

-   **Potential SQL injection attacks** - including vulnerabilities detected when applications generate a faulty SQL statement in the database
-   **Anomalous database access and query patterns** - for example, an abnormally high number of failed sign-in attempts with different credentials (a brute force attempt)
-   **Suspicious database activity** - for example, a legitimate user accessing an SQL Server from a breached computer which communicated with a crypto-mining C&C server

Alerts include details of the incident that triggered them, as well as recommendations on how to investigate and remediate threats. Learn more about the [security alerts for SQL servers](https://learn.microsoft.com/azure/defender-for-cloud/alerts-reference#alerts-sql-db-and-warehouse).

## Defender for Azure Cosmos DB

Microsoft Defender for Azure Cosmos DB detects potential SQL injections, known bad actors based on Microsoft Threat Intelligence, suspicious access patterns, and potential exploitation of your database through compromised identities, or malicious insiders.

Defender for Azure Cosmos DB uses advanced threat detection capabilities, and [Microsoft Threat Intelligence](https://www.microsoft.com/insidetrack/microsoft-uses-threat-intelligence-to-protect-detect-and-respond-to-threats) data to provide contextual security alerts. Those alerts also include steps to mitigate the detected threats and prevent future attacks.

You can [enable protection for all your databases](https://learn.microsoft.com/azure/defender-for-cloud/quickstart-enable-database-protections) (recommended), or [enable Microsoft Defender for Azure Cosmos DB](https://learn.microsoft.com/azure/defender-for-cloud/quickstart-enable-database-protections) at either the subscription level, or the resource level.

Defender for Azure Cosmos DB continually analyzes the telemetry stream generated by the Azure Cosmos DB service. When potentially malicious activities are detected, security alerts are generated. These alerts are displayed in Defender for Cloud together with the details of the suspicious activity along with the relevant investigation steps, remediation actions, and security recommendations.

Defender for Azure Cosmos DB doesn't access the Azure Cosmos DB account data, and doesn't have any effect on its performance.

### What are the benefits of Microsoft Defender for Azure Cosmos DB

Microsoft Defender for Azure Cosmos DB uses advanced threat detection capabilities and Microsoft Threat Intelligence data. Defender for Azure Cosmos DB continuously monitors your Azure Cosmos DB accounts for threats such as SQL injection, compromised identities and data exfiltration.

This service provides action-oriented security alerts in Microsoft Defender for Cloud with details of the suspicious activity and guidance on how to mitigate the threats. You can use this information to quickly remediate security issues and improve the security of your Azure Cosmos DB accounts.

Alerts include details of the incident that triggered them, and recommendations on how to investigate and remediate threats. Alerts can be exported to Microsoft Sentinel or any other third-party SIEM or any other external tool. To learn how to stream alerts, see [Stream alerts to a SIEM, SOAR, or IT classic deployment model solution](https://learn.microsoft.com/azure/defender-for-cloud/export-to-siem).

### Alert types

Threat intelligence security alerts are triggered for:

-   **Potential SQL injection attacks**:  
    Due to the structure and capabilities of Azure Cosmos DB queries, many known SQL injection attacks can’t work in Azure Cosmos DB. However, there are some variations of SQL injections that can succeed and may result in exfiltrating data from your Azure Cosmos DB accounts. Defender for Azure Cosmos DB detects both successful and failed attempts, and helps you harden your environment to prevent these threats.
    
-   **Anomalous database access patterns**:  
    For example, access from a TOR exit node, known suspicious IP addresses, unusual applications, and unusual locations.
    
-   **Suspicious database activity**:  
    For example, suspicious key-listing patterns that resemble known malicious lateral movement techniques and suspicious data extraction patterns.
