jobs: 
  lint: 
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - script: |
        az bicep build --file deploy/main.bicep
  
  validate: 
    runs-on: ubuntu-latest
    steps: 
    - uses: actions/checkout@v2
    - uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    - uses: azure/CLI@v1
      with:
        inlineScript: |
          az deployment group validate \
            --resource-group ${{ env.AZURE_RESOURCEGROUP_NAME }} \
            --template-file deploy/main.bicep
 
