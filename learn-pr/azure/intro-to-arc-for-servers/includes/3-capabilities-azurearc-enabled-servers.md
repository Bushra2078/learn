Azure Arc allows you to extend the scope of several Azure services to non-Azure Windows and Linux servers. This helps companies like Contoso to standardize their management strategy when operating in hybrid scenarios. In this unit, you will learn about the capabilities of Azure Arc, focusing on those available exclusively to Azure and Azure Arc enabled servers. 

## What are the key capabilities of Azure Arc?

A number of Azure Arc benefits are independent of the resouce type, since they reflect the capabilities of Azure Resource Manager. These benefits include:

- The ability to organize all organizational resources by using Azure management groups, subscriptions, resource groups, and tags.
- A single, comprehensive inventory of organizational assets across multi-clouds and on-premises, including support for searching and indexing by using Azure Resource Graph.
- A consolidated view of Azure and Azure Arc enabled resources via the Azure portal, Azure CLI, Azure PowerShell, and Azure REST API. <!--Marcin: did you explain these acronyms yet? Or are they very common?--> 
- Direct access from the Azure portal to the majority of management features of the Azure Arc enabled servers: 

| Setting | Explanation |
| --- | --- |
| Overview | Provides basic information about the Azure resource and the corresponding Arc enabled server, including status, location, subscription, computer name, operating system, and tags. |
| Activity log | Lists Azure Resource Manager-based changes affecting the state of the Azure resource representing the Arc enabled server, including information identifying the initiator of that change. |
| Access control | Enables you to view, grant, and revoke permissions to perform management tasks on the Azure resource representing the Arc enabled server. |
| Tags | Allow you to view, assign, and remove tags consisting of name/value pairs, which provide you with a mechanism to label and categorize the Azure resource representing the Arc enabled server in an arbitrary manner. You can also use them to facilitate consolidated billing by applying tags that map to cost centers reflecting your charge-back policies. |
| Extensions | Allow you to automate configuration of the operating system and applications running within the Arc enabled server by using VM extensions. |
| Locks | Allow you to prevent accidental changes or deletions of the Azure resource corresponding to the Arc enabled server. |
| Policies | Allow you to audit operating system and application settings of the Arc enabled server. |
| Update management | Allows you to implement automatic deployment and reporting of operating system updates on the Arc enabled server. |
| Inventory | Allows you to implement inventory of the Arc enabled server. |
| Change tracking | Allows you to implement change tracking the Arc enabled server. |
| Insights | Allow you to use Azure Monitor to review host CPU, disks, and the operating system state of the Arc enabled server. |
| Logs | Allow you to collect and analyze logs generated by the operating system and applications on the Arc enabled server. |

:::image type="content" source="../media/3-access-control.png" alt-text="Screenshot of the Access control (IAM) page in the Azure portal for the selected VM: ContosoVM1. The details pane displays a number of tabs: Check access (selected), Role assignments, Deny assignments, Classic administrators, and Roles." border="false":::

There are also benefits specific to Azure Arc enabled servers, such as:

- The ability to apply Azure VM extensions to automate configuration of Azure and non-Azure Windows and Linux servers in the consistent manner.
- The Support for Azure Policy guest configuration. Azure Policy supports auditing Azure Arc enabled servers in the same way as their Azure-resident counterparts. This allows you to use the same approach to evaluate whether configurations of all servers in your environment comply with organizational standards.

### What are VM extensions?

VM extensions are lightweight software components that automate post-operating system deployment configuration and automation tasks. Traditionally, VM extensions were available only on Azure VMs, but now it is possible to use selected ones on Azure Arc enabled servers. The following table describes the Windows Server extensions that you can add to Azure Arc enabled servers.

| Extension | Additional information |
| --- | --- |
| CustomScriptExtension | Executes a script on the target Arc enabled server. |
| DSC | Applies a PowerShell DSC configuration on the target Arc enabled server. |
| Log Analytics agent | Installs the Log Analytics agent on the target Arc enabled server and configures it for log forwarding to a Log Analytics workspace. |
| Microsoft Dependency agent | Installs the Dependency agent on the target Arc enabled server to facilitate identifying internal and external dependencies of server workloads. |

> [!NOTE] 
> The equivalent VM extensions are available for Arc enabled servers running Linux.

### What is the role of Azure Policy in managing Arc enabled Azure Stack HCI VMs?

Azure Policy is a service that can help organizations manage and evaluate internal and regulatory compliance of their Arc enabled servers, in addition to a wide range of Azure services. Azure Policy uses declarative rules based on properties of target resource types, including Windows and Linux operating systems. These rules form policy definitions, which administrators can apply through policy assignment to resource groups, subscriptions, or management groups that host Azure Arc enabled servers. To simplify management of policy definitions, it is possible to combine multiple policies into initiatives, and then create a few of initiative assignments in lieu of multiple policy assignments.

Azure Policy supports auditing the state of Arc enabled server with Guest Configuration policies. Guest Configuration policies do not apply configurations, but they audit settings within the target operating system and evaluate their compliance. You can, however, use Azure Policy to apply configuration of the Azure resource representing an Arc enabled server. You also have the ability to use Azure Policy to deploy configurations by leveraging VM extensions.

For example, Contoso could use Azure Policy to implement the following rules:

- Assigning a specific tag to resources representing Arc enabled servers during their registration.
- Identify Arc enabled servers running Windows with Windows Defender Exploit Guard disabled.
- Identify Arc enabled servers running Windows that are not joined to a specific Active Directory Domain Services (AD DS) domain.
- Identify Arc enabled servers running Windows or Linux without Log Analytics agent installed.
- Identify Arc enabled servers running Linux that are not using SSH keys for authentication.
<!--Marcin: I deleted the two links here. I hope this is correct? They were the same as in the next subtitle-->

### Assign policies to Azure Arc enabled servers

You can manage and assign Azure policies to Azure Arc enabled servers directly from the Azure portal. 

:::image type="content" source="../media/3-assign-policy.png" alt-text="The screenshot depicts the Assign policy page in the Azure portal. The administrator is selecting from a list of available policies." border="false":::

Once you create a policy assignment, shortly afterwards, you will be able to review the outcome of the policy evaluation on the target Azure Arc enabled servers.

:::image type="content" source="../media/3-review-policies.png" alt-text="The screenshot depicts the applied policies on ContosoVM1. Two policies are applied, and the VM is compliant with one but not the other." border="false":::
