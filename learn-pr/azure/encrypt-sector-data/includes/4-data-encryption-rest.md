Azure provides extensive options for [data encryption at rest](https://docs.microsoft.com/azure/security/fundamentals/encryption-atrest) to help customers safeguard their data and meet their compliance needs using Microsoft-managed encryption keys and customer-managed encryption keys. This process relies on multiple encryption keys, as well as services such as Azure Key Vault and Azure Active Directory, to ensure secure key access and centralized key management. In general, controlling key access and ensuring efficient bulk encryption and decryption of data is accomplished with the following types of encryption keys:

* **Data Encryption Key (DEK)** is a symmetric AES-256 key that is used for bulk encryption and decryption of a partition or a block of data. Access to DEKs is needed by the resource provider or application instance that’s responsible for encrypting and decrypting a specific block of data. A single resource may have many partitions and many DEKs. When a DEK is replaced with a new key, only the data in its associated block must be re-encrypted with the new key. DEK is encrypted by the Key Encryption Key (KEK) and is never stored unencrypted.

* **Key Encryption Key (KEK)** is an asymmetric RSA-2048 key that’s optionally provided by the customer. This key is used to encrypt the Data Encryption Key (DEK) using Azure Key Vault and exists only in Azure Key Vault. KEK is never exposed directly to the resource provider or other services. Access to KEK is controlled by permissions in Azure Key Vault and access to Azure Key Vault must be authenticated through Azure Active Directory. These permissions can be revoked to block access to this key and, by extension, the data that’s encrypted using this key as the root of the key chain.

Detailed information about various encryption models and specifics on key management for a wide range of Azure platform services are available in [online documentation](https://docs.microsoft.com/azure/security/fundamentals/encryption-atrest#encryption-at-rest-in-microsoft-cloud-services). The rest of this section covers encryption implementation for key scenarios, including Storage service encryption, Azure SQL Database Transparent Data Encryption (TDE), and Azure Disk encryption.

## Ensure data is automatically encrypted

Azure Storage service encryption for data at rest ensures that data is automatically encrypted before persisting it to Azure Storage and decrypted before retrieval. By default, Microsoft controls the encryption keys and is responsible for key rotation, usage, and access. Keys are stored securely and protected inside a Microsoft key store. This option provides the most convenience for customers given that all Azure Storage services are supported. However, customers can also choose to manage encryption with their own keys by specifying customer-managed key in Azure Key Vault for encrypting and decrypting all Blob storage and Azure Files, or customer-provided key in Azure Key Vault or another store on customer premises for encrypting and decrypting Blob storage only.

Storage service encryption is enabled by default for all new and existing storage accounts and it can't be disabled. The encryption process leverages two separate keys as described previously: symmetric AES-256 DEK and asymmetric RSA-2048 KEK.

## Perform real-time encryption

Azure SQL Database provides [Transparent Data Encryption](https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-azure-sql) (TDE) at rest by [default](https://azure.microsoft.com/updates/newly-created-azure-sql-databases-encrypted-by-default/). TDE performs real-time encryption and decryption operations on the data and log files. Database Encryption Key (DEK) is a symmetric key stored in the database boot record for availability during recovery. It’s secured via a certificate stored in the primary database of the server or an asymmetric key called TDE Protector stored under customer control in Azure Key Vault, which is Azure’s cloud-based external key management system. Azure Key Vault supports *bring your own key* (BYOK), which enables customers to store TDE Protector in Key Vault and control key management tasks including key rotation, permissions, deleting keys, enabling auditing/reporting on all TDE Protectors, and so on. The key can be generated by the Key Vault, imported, or [transferred to the Key Vault from an on-premises HSM device](https://docs.microsoft.com/azure/key-vault/key-vault-hsm-protected-keys). Customers can also use the Always Encrypted feature of Azure SQL Database, which is designed specifically to help protect sensitive data. It allows clients to encrypt data inside client applications and never reveal the encryption keys to the [Database Engine](https://docs.microsoft.com/sql/relational-databases/security/encryption/always-encrypted-database-engine). This way, Always Encrypted provides separation between those who own the data (and can view it) and those who manage the data (but should have no access).

## Encrypt disks for virtual machines

Azure Storage service encryption encrypts the page blobs that store Azure Virtual Machine disks. Additionally, [Azure Disk Encryption](https://docs.microsoft.com/azure/security/fundamentals/azure-disk-encryption-vms-vmss) (ADE) may optionally be used to encrypt all Azure Windows and Linux IaaS Virtual Machine disks. This encryption includes [managed disks](https://docs.microsoft.com/azure/virtual-machines/windows/managed-disks-overview). ADE leverages the industry standard [BitLocker](https://docs.microsoft.com/windows/security/information-protection/bitlocker/bitlocker-overview) feature of Windows and the [DM-Crypt](https://gitlab.com/cryptsetup/cryptsetup/wikis/DMCrypt) feature of Linux to provide volume encryption for the OS and data disks used by an IaaS Virtual Machine. The solution is integrated with Azure Key Vault to help customers control and manage the disk encryption keys. Customers can supply their own encryption keys, which are safeguarded in Azure Key Vault to support Bring Your Own Key (BYOK) scenarios. ADE relies on two encryption keys as described previously: 1) symmetric AES-256 DEK used to encrypt OS and data volumes, and 2) asymmetric RSA-2048 KEK used to encrypt DEK and stored in Azure Key Vault under customer control.

Next, let’s explore how Azure can protect data while it’s in use.
