In the previous unit, you worked through a scenario that involved high availability for a 911 dispatch system. In this unit, you'll review one potential solution and some other items to consider.

As you review, you should compare the provided solution to the one that you developed in the previous unit. Often, more than one correct solution exists for any problem, but there are always tradeoffs. Which items in your solution differ from the proposed one? Is there anything in your solution you might rethink? Is there anything in the provided solution that you think is addressed more thoroughly in your solution?

## Deployment option and configuration

Similar to the previous scenario, the first selection in addressing a scenario is often to identify which Azure SQL deployment option will potentially be the best fit. If you consider SLA alone, the requirement is for an SLA of 99.995%, which can only be provided by Azure SQL Database today. Specifically, to get this SLA, the Business critical service tier must be deployed, and the use of availability zones should be enabled.

Another set of decisions is related to how to enable geo-redundancy and maintain high availability in disasters. While geo-replication and auto-failover groups are both options here, auto-failover groups will enable the customer to failover if it's required, without changing any connection strings. This setup can potentially help in reducing downtime to update the applications' connection strings, because it will not be needed. You can also configure monitoring queries to check the status. That way, if something goes wrong, you could even force a failover.

In this configuration, it is also important to think about the role colocation plays. To maintain high availability, your application needs to be as close to your database as possible, certainly in the same region. You'll want to make sure your application is deployed in both regions of the auto-failover group, so a redundant copy of the application (for example, a web app) exists. If there's a failover, you can use Traffic Manager to reroute traffic to the application in the secondary region.

## DBAs and sensitive data

The 911 dispatch system coordinators have expressed concern about protecting sensitive data (like health history and other personal information), while allowing DBAs to do their jobs.

To ensure DBAs cannot see sensitive data stored in specific columns and all access to tables containing sensitive data must be monitored, there are a few Azure SQL technologies that can be leveraged. Using SQL Audit is a best practice to monitor access, but DBAs will still be able to see the data. Classifying the sensitive data with Data Classification will help, because the sensitive data will be labeled and you can track it with SQL Audit. However, with these implemented, DBAs will still be able to see sensitive data. Dynamic data masking can be used to help mask sensitive data, but it is not possible to keep a db_owner from viewing user data with permissions only. If there's highly sensitive data in a database, Always Encrypted can be used to safely prevent even db_owners from seeing it. Additionally, you can manage the Always Encrypted keys with role separation, so that the security admin does not access the database, and the DBA does not access the physical keys in plaintext. By using this strategy in combination with monitoring with SQL Audit, you can monitor, mask, and track access to sensitive data, even from DBAs with db_owner rights.

While DBAs need to have sensitive data masked, they still need to be able to troubleshoot performance using the Azure portal and SSMS/ADS, and they need to be able to create new contained database users who must be mapped to Azure AD principals. To achieve this task, one solution is to create an Azure AD group SQL DBA for the DBAs on the respective instance. Then, assign the group to the Azure RBAC role SQL Server Contributor. Finally, you can set the group to be the Azure AD admin on the logical server.
