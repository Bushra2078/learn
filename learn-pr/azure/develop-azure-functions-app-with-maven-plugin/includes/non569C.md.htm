<html>
<head>
<style>
body,html{font-family:Segoe UI,SegoeUI,Segoe WP,Helvetica Neue,Helvetica,Tahoma,Arial,sans-serif;font-weight:400;text-rendering:optimizeLegibility}
table,th,td{border:1px solid #000;border-collapse:collapse;padding:5px;}
blockquote{background-color:#eef;padding:5px;}
</style>
</head>
<body>
<p>In the previous exercise, you created an Azure Function project using an Azure Maven archetype. Your next task is to build your function, and run it locally to verify that it works.</p>
<p>In this unit, you'll learn about the Azure Functions Core Tools, which help you run and test your functions locally. You'll also learn how to open an HTTP port for testing, how to run your function in the Cloud Shell, and how to test your function in a web browser.</p>
<h2 id="what-are-the-azure-functions-core-tools">What are the Azure Functions Core Tools</h2>
<p>Azure Functions Core Tools are a suite of utilities for building and testing Azure Functions locally using a terminal emulator or command prompt. Even though the Azure Functions you create are running locally, they can access live Azure services during your testing. When you've completed your testing and your function is ready to publish, you can deploy your function application to your Azure subscription.</p>
<p>At this time, there are three versions of the Azure Functions Core Tools. However, as a general rule, unless you have a specific need to use an earlier version, you should always use the latest version when you are developing functions for deployment to Azure. For this module, you'll use the Azure Cloud Shell in the Learn sandbox, which has the latest version of the Azure Functions Core Tools.</p>
<blockquote>
<p>[!NOTE]</p>
<p>If you were using your personal Azure account instead of the Cloud Shell in the Learn sandbox, you would need to consult <a href="https://docs.microsoft.com/azure/azure-functions/functions-run-local">Work with Azure Functions Core Tools</a> for descriptions, requirements, and installation instructions for the different versions of the Azure Functions Core Tools.</p>
</blockquote>
<h2 id="configuring-the-cloud-shell-environment-for-testing">Configuring the Cloud Shell environment for testing</h2>
<p>When you are testing a web-based application that runs in the Cloud Shell, you have two different ways of testing the application:</p>
<ol>
<li><p>You can use the Cloud Shell to open an external port for testing, which will route HTTP requests to the localhost port of your Cloud Shell instance:</p>
<ul>
<li><p>To open port 7071 from the Cloud Shell, you would use the following cURL command:</p>
<pre><code class="language-bash">curl -X POST http://localhost:8888/openPort/7071
</code></pre>
</li>
<li><p>When you have completed your testing, you would use the following cURL command to close the port:</p>
<pre><code class="language-bash">curl -X POST http://localhost:8888/closePort/7071
</code></pre>
</li>
</ul>
</li>
<li><p>You can open mutiple instances of the Cloud Shell to test the application locally:</p>
<ul>
<li><p>You would run the application in the first instance.</p>
</li>
<li><p>You would use cURL to test the application from the second instance.</p>
</li>
</ul>
</li>
</ol>
<p>In the next exercise, you'll use the first method to open a port.</p>
<h2 id="running-your-function-in-the-cloud-shell">Running your function in the Cloud Shell</h2>
<p>Once you have opened a port for testing, your next task would be to build and execute your function. To do so, use the following steps:</p>
<ol>
<li><p>In the Cloud Shell, you would change directory to the root folder of your project.</p>
</li>
<li><p>To build your application, you would use the following Maven command:</p>
<pre><code class="language-bash">mvn clean package
</code></pre>
</li>
<li><p>To run the application, you would use the following Maven command:</p>
<pre><code class="language-bash">mvn azure-functions:run
</code></pre>
<p>While Maven is preparing the runtime environment for your function, you'll see the Azure Functions Core Tools logo displayed:</p>
<p><img src="../media/4-mvn-azure-function-startup.png" alt="Image showing the Azure Function Core tools logo" /></p>
</li>
<li><p>Once you have completed your testing, you would use <kbd>CTRL+C<kbd> command from the Azure Cloud Shell to stop the server.</p>
</li>
</ol>
<h2 id="testing-your-function-using-http-requests">Testing your function using HTTP requests</h2>
<p>In this module, you will be using a single instance of the Cloud Shell. As a result, you will need to test your application by opening a new tab in your web browser. In the browser's address bar, you would enter a URL that resembles the following:</p>
<pre><code class="language-bash">https://gateway.westus.console.azure.com/n/cc-12345678/cc-12345678/proxy/7071/api/HttpExample?name=Bob
</code></pre>
<p>However, if you were using multiple instances of the Cloud Shell, you could use the following cURL command to test your application from a separate instance of the shell:</p>
<pre><code class="language-bash">curl http://localhost:7071/api/HttpExample?name=Bob
</code></pre>
<p>In the next exercise, you'll use what you have learned in this unit to open a testing port, run your function in the Cloud Shell, and determine the URL that you'll need to use in order to test your function from a web browser.</p>

</body>
</html>
